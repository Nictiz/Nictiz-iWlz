<?xml version="1.0" encoding="UTF-8"?>
<OperationDefinition xmlns="http://hl7.org/fhir" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://hl7.org/fhir http://hl7.org/fhir/STU3/operationdefinition.xsd">
    <id value="iwlz-Indicaties"/>
    <url value="http://nictiz.nl/fhir/OperationDefinition/iwlz-Indicaties"/>
    <name value="Retrieve Indicatiebesluiten"/>
    <status value="draft"/>
    <kind value="operation"/>
    <experimental value="false"/>
    <publisher value="Nictiz"/>
    <contact>
        <name value="Nictiz"/>
        <telecom>
            <system value="email"/>
            <value value="info@nictiz.nl"/>
            <use value="work"/>
        </telecom>
    </contact>
    <description value="This operation is used to return all 'indicatiebesluiten' Composition resources and referenced information related to a patient. This operation assumes that the server has identified and secured the context appropriately, and can either associate the authorization context with a single patient, or determine whether the context has the rights to the nominated patient. Otherwise, the use of the `patient` parameter might be required. The response is a bundle of type &quot;searchset&quot;. Included in the bundle are all Composition resources representing 'indicatiebesluiten' associated with the patient (with `entry.search.mode` set to 'match') and _all_ resources referenced by the Composition resources and by the referenced resources themselves (with `entry.search.mode` set to 'include'). All resources SHALL conform to the profiles defined by the information standard ['iWlz'](https://informatiestandaarden.nictiz.nl/wiki/MedMij:Vpoc_1.0/OntwerpiWlz). If there are no 'indicatiebesluit' related resources, this operation SHALL return an empty bundle, preferably containing an OperationOutcome resource."/>
    <purpose value="The Composition/$document operation is only suitable for retrieving one specific Composition and all its referenced resources. This operation enables the simultaneous search and retrieval of one or more Compositions and its referenced resources in one interaction. Discussions on generalization and specification of this use case are ongoing (see `OperationDefinition.comment`)."/>
    <code value="indicaties"/>
    <comment value="While initially the $document operation (https://www.hl7.org/fhir/stu3/composition-operations.html#document) was to be used, its text left many ambiguity on the exact use of the operation and if it would be allowed to use for a simultaneous search and 'resolve' operation. A discussion within the FHIR community (see https://jira.hl7.org/browse/FHIR-36699) led to the conclusion that $document is not meant to be used this way and that its definition is going to be clarified in future FHIR versions. Discussions are ongoing within the Structured Documents Working Group if a new operation that supports the search and retrieval of multiple document Compositions shall be proposed. This operation SHALL be revoked in the future if this core operation is accepted."/>
    <system value="false"/>
    <type value="true"/>
    <instance value="false"/>
    <parameter>
        <name value="patient"/>
        <use value="in"/>
        <min value="0"/>
        <max value="1"/>
        <documentation value="The id of a patient resource located on the server on which this operation is executed. 
      This paramater is not be necessary for use in MedMij because all RESTful actions are perfomed in the context of a specific authenticated patient, for which an OAuth2 token has been retrieved using the authentication mechanisms described in the 'Afsprakenstelsel'. 
      Each XIS Gateway is required to perform filtering based on the patient associated with the OAuth2 token received for the request, so that only the records associated with the authenticated patient are returned. 
      Therefore, no parameters should be passed for patient identification."/>
        <type value="Identifier"/>
    </parameter>
    <parameter>
        <name value="return"/>
        <use value="out"/>
        <min value="1"/>
        <max value="1"/>
        <documentation value="All 'indicatiebesluiten' Composition associated with the patient, including all resources referenced in the Compositions and its referenced profiles. The bundle type is &quot;searchset&quot;."/>
        <type value="Bundle"/>
    </parameter>
</OperationDefinition>